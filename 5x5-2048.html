<!DOCTYPE html>
<html>

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width">
  <title>5x5 2048 by Evan Pereira</title>
  <link href="style.css" rel="stylesheet" type="text/css" />
  <style>
    html {background:lightblue;font-family:Arial;}
    
    .space {
      display: grid;
      grid-template-columns: repeat(5, 70px);
      grid-template-rows: repeat(5, 70px);
      justify-content: center;
      text-align: center;
    }

    .space div {
      display: flex;
      justify-content: center;
      align-items: center;
      font-size: 20px;
      font-weight: 700;
      border: 4px solid black;
      background-color: white;
      border-radius: 5px;
      margin: -3px;
    }
  </style>
</head>

<body>
  <center><em><h1><u>5x5 2048</u></h1></em></center>
  <div class="space">
    <div id="00"></div>
    <div id="01"></div>
    <div id="02"></div>
    <div id="03"></div>
    <div id="04"></div>
    <div id="10"></div>
    <div id="11"></div>
    <div id="12"></div>
    <div id="13"></div>
    <div id="14"></div>
    <div id="20"></div>
    <div id="21"></div>
    <div id="22"></div>
    <div id="23"></div>
    <div id="24"></div>
    <div id="30"></div>
    <div id="31"></div>
    <div id="32"></div>
    <div id="33"></div>
    <div id="34"></div>
    <div id="40"></div>
    <div id="41"></div>
    <div id="42"></div>
    <div id="43"></div>
    <div id="44"></div>
  </div>
  <strong><p id="score" style="font-size:150%;text-align:center;">Score: 0</p></strong>
  <script>
    function canMove(direction) {
      let copy = [
        [0, 0, 0, 0, 0],
        [0, 0, 0, 0, 0],
        [0, 0, 0, 0, 0],
        [0, 0, 0, 0, 0],
        [0, 0, 0, 0, 0]
      ];
      for (var i = 0; i < 5; i++) {
        for (var j = 0; j < 5; j++) {
          copy[i][j] = board[i][j];
        }
      }
      direction();
      document.getElementById("score").innerHTML = "Score: " + score;
      for (var i = 0; i < 4; i++) {
        for (var j = 0; j < 4; j++) {
          if (!board.flat().includes(0) && board[i][j] !== board[i][j + 1] && board[i][j] !== board[i + 1][j]) {
            document.getElementById("score").innerHTML = "You lose! Final Score: " + score;
            return;
          }
        }
      }
      for (var i = 0; i < 5; i++) {
        for (var j = 0; j < 5; j++) {
          if (copy[i][j] !== board[i][j]) {
            randomPiece();
            updateColors();
            return;
          }
        }
      }
    }
    
    document.onkeydown = move;
    function move(e) {
      e = e || window.event;
      if (e.keyCode == '38') {
        canMove(up);
      } else if (e.keyCode == '40') {
        canMove(down);
      } else if (e.keyCode == '37') {
        canMove(left);
      } else if (e.keyCode == '39') {
        canMove(right);
      }
    }

    var board = [
      [0, 0, 0, 0, 0],
      [0, 0, 0, 0, 0],
      [0, 0, 0, 0, 0],
      [0, 0, 0, 0, 0],
      [0, 0, 0, 0, 0]
    ];
    let mergeR = true;
    let mergeL = true;
    let mergeU = true;
    let mergeD = true;
    var score = 0;
    function randomPiece() {
      while (true) {
        var i = Math.floor(Math.random() * 5);
        var j = Math.floor(Math.random() * 5);
        if (board[i][j] == 0) {
          if (Math.floor(Math.random() * 10) == 9) {
            board[i][j] = 4;
            document.getElementById(i.toString() + j.toString()).innerHTML = 4;
          } else {
            board[i][j] = 2;
            document.getElementById(i.toString() + j.toString()).innerHTML = 2;
          }
          break;
        }
      }
    }
    randomPiece();
    updateColors();

    function updateColors() {
      for (var i = 0; i < 5; i++) {
        for (var j = 0; j < 5; j++) {
          let spot = document.getElementById(i.toString() + j.toString());
          if (spot.innerHTML == 2) {
            spot.style.background = "silver";
          } else if (spot.innerHTML == 4) {
            spot.style.background = "brown";
          } else if (spot.innerHTML == 8) {
            spot.style.background = "coral";
          } else if (spot.innerHTML == 16) {
            spot.style.background = "turquoise";
          } else if (spot.innerHTML == 32) {
            spot.style.background = "orange";
          } else if (spot.innerHTML == 64) {
            spot.style.background = "purple";
          } else if (spot.innerHTML == 128) {
            spot.style.background = "red";
          } else if (spot.innerHTML == 256) {
            spot.style.background = "pink";
          } else if (spot.innerHTML == 512) {
            spot.style.background = "tan";
          } else if (spot.innerHTML == 1024) {
            spot.style.background = "gold";
          } else if (spot.innerHTML == 2048) {
            spot.style.background = "magenta";
          } else if (spot.innerHTML == 4096) {
            spot.style.background = "teal";
          } else if (spot.innerHTML == 8192) {
            spot.style.background = "blue";
          } else if (spot.innerHTML > 8192) {
            spot.style.background = "cyan";
          }
        }
      }
    }
    
    function right() {
      for (var i = 0; i < 5; i++) {
        for (var r = 0; r < 5; r++) {
          for (var c = 3; c > -1; c--) {
            var k = c + 1;
            if (board[r][k] == 0 && board[r][c] > 0) {
              board[r][k] = board[r][c];
              board[r][c] = 0;
              document.getElementById(r.toString() + k.toString()).innerHTML = board[r][k];
              document.getElementById(r.toString() + c.toString()).innerHTML = "";
              document.getElementById(r.toString() + c.toString()).style.background = "white";
            }
          }
        }
      }
      for (var i = 0; i < 5; i++) {
        for (var j = 4; j > -1; j--) {
          if (board[i][j] == board[i][j - 1] && board[i][j] !== 0 && mergeR) {
            board[i][j - 1] *= 2;
            score += board[i][j - 1];
            board[i][j] = 0;
            document.getElementById(i.toString() + (j - 1).toString()).innerHTML = board[i][j - 1];
            document.getElementById(i.toString() + j.toString()).innerHTML = "";
            document.getElementById(i.toString() + j.toString()).style.background = "white";
            mergeR = false;
            right();
          }
        }
      }
      mergeR = true;
    }

    function left() {
      for (var i = 0; i < 5; i++) {
        for (var r = 0; r < 5; r++) {
          for (var c = 1; c < 5; c++) {
            var k = c - 1;
            if (board[r][k] == 0 && board[r][c] > 0) {
              board[r][k] = board[r][c];
              board[r][c] = 0;
              document.getElementById(r.toString() + k.toString()).innerHTML = board[r][k];
              document.getElementById(r.toString() + c.toString()).innerHTML = "";
              document.getElementById(r.toString() + c.toString()).style.background = "white";
            }
          }
        }
      }
      for (var i = 0; i < 5; i++) {
        for (var j = 0; j < 5; j++) {
          if (board[i][j] == board[i][j + 1] && board[i][j] !== 0 && mergeL) {
            board[i][j] *= 2;
            score += board[i][j];
            board[i][j + 1] = 0;
            document.getElementById(i.toString() + j.toString()).innerHTML = board[i][j];
            document.getElementById(i.toString() + (j + 1).toString()).innerHTML = "";
            document.getElementById(i.toString() + (j + 1).toString()).style.background = "white";
            mergeL = false;
            left();
          }
        }
      }
      mergeL = true;
    }

    function up() {
      for (var i = 0; i < 5; i++) {
        for (var r = 1; r < 5; r++) {
          for (var c = 0; c < 5; c++) {
            var k = r - 1;
            if (board[k][c] == 0 && board[r][c] > 0) {
              board[k][c] = board[r][c];
              board[r][c] = 0;
              document.getElementById(k.toString() + c.toString()).innerHTML = board[k][c];
              document.getElementById(r.toString() + c.toString()).innerHTML = "";
              document.getElementById(r.toString() + c.toString()).style.background = "white";
            }
          }
        }
      }
      for (var i = 1; i < 5; i++) {
        for (var j = 0; j < 5; j++) {
          if (board[i][j] == board[i - 1][j] && board[i][j] !== 0 && mergeU) {
            board[i][j] *= 2;
            score += board[i][j];
            board[i - 1][j] = 0;
            document.getElementById(i.toString() + j.toString()).innerHTML = board[i][j];
            document.getElementById((i - 1).toString() + j.toString()).innerHTML = "";
            document.getElementById((i - 1).toString() + j.toString()).style.background = "white";
            mergeU = false;
            up();
          }
        }
      }
      mergeU = true;
    }

    function down() {
      for (var i = 0; i < 5; i++) {
        for (var r = 3; r > -1; r--) {
          for (var c = 0; c < 5; c++) {
            var k = r + 1;
            if (board[k][c] == 0 && board[r][c] > 0) {
              board[k][c] = board[r][c];
              board[r][c] = 0;
              document.getElementById(k.toString() + c.toString()).innerHTML = board[k][c];
              document.getElementById(r.toString() + c.toString()).innerHTML = "";
              document.getElementById(r.toString() + c.toString()).style.background = "white";
            }
          }
        }
      }
      for (var i = 3; i > -1; i--) {
        for (var j = 0; j < 5; j++) {
          if (board[i][j] == board[i + 1][j] && board[i][j] !== 0 && mergeD) {
            board[i + 1][j] *= 2;
            score += board[i + 1][j];
            board[i][j] = 0;
            document.getElementById((i + 1).toString() + j.toString()).innerHTML = board[i + 1][j];
            document.getElementById(i.toString() + j.toString()).innerHTML = "";
            document.getElementById(i.toString() + j.toString()).style.background = "white";
            mergeD = false;
            down();
          }
        }
      }
      mergeD = true;
    }
  </script>
  <script src="script.js"></script>
</body>
</html>
